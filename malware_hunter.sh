#!/bin/bash

directory="/path/to/directory"  # Specify the directory to scan

echo "Scanning for potentially malicious Python, PHP, and Bash code files..."

# Find potentially malicious Python files
echo "Potential malicious Python code files:"
find "$directory" -type f -name "*.py" -exec grep -lE "(exec\(|eval\()" {} +

# Find potentially malicious PHP files
echo "Potential malicious PHP code files:"
find "$directory" -type f -name "*.php" -exec grep -lE "(eval|assert|system|shell_exec|passthru|exec|popen|proc_open|pcntl|phpinfo|base64_decode|gzinflate|gzuncompress|chr\(|\$\w+\s*\(|@\w+\s*\()" {} +

# Find potentially malicious Bash script files
echo "Potential malicious Bash script files:"
find "$directory" -type f -name "*.sh" -exec grep -lE "(exec\s|eval\s|system\s|bash\s|wget\s|curl\s)" {} +

echo "Scan complete."
